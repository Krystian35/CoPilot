{% extends 'base.html' %}

{% block title %}Products - Catalog{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1>Products</h1>
  <a href="{{ url_for('products.add_product') }}" class="btn btn-success">Add Product</a>
</div>

{% if products %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>Category</th>
      <th>Price</th>
      <th>Stock</th>
      <th style="width:180px">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for p in products %}
    <tr>
      <td>
        {% if p.image %}
        <img src="{{ url_for('static', filename='images/' ~ p.image) }}" alt="{{ p.title }}"
          style="height:48px; margin-right:8px;">
        {% else %}
        <img src="{{ url_for('static', filename='images/placeholder.svg') }}" alt="placeholder"
          style="height:48px; margin-right:8px;">
        {% endif %}
        {{ p.title }}
      </td>
      <td>{{ p.author }}</td>
      <td>{{ p.category_name }}</td>
      <td>{{ '%.2f'|format(p.price) if p.price is not none else '' }}</td>
      <td>{{ p.stock }}</td>
      <td>
        <a href="{{ url_for('products.edit_product', product_id=p.id) }}" class="btn btn-sm btn-primary">Edit</a>
        <a href="{{ url_for('products.delete_product', product_id=p.id) }}" class="btn btn-sm btn-danger">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No products yet. <a href="{{ url_for('products.add_product') }}">Add one</a>.</p>
{% endif %}
{% endblock %}